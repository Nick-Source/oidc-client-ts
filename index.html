<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>oidc-client-ts</title><meta name="description" content="Documentation for oidc-client-ts"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">oidc-client-ts</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>oidc-client-ts</h2></div><div class="tsd-panel tsd-typography"><p><a href="https://github.com/authts/oidc-client-ts">oidc-client-ts</a> is a TypeScript library intended to be used by web applications and run in browsers. It provides protocol support for OIDC and OAuth2, as well as management functions for user sessions and access tokens management.</p>
<p>If you are unfamiliar with OpenID Connect, then you should learn the
<a href="https://openid.net/specs/openid-connect-core-1_0.html">protocol</a> first. This
library is designed as a spec-compliant protocol library.</p>
<p>There are two main classes that you might want to use depend on the level at
which you use to use the library:</p>
<ul>
<li><a href="classes/UserManager.html">UserManager</a> provides a higher level API for
signing a user in, signing out, managing the user's claims</li>
<li><a href="classes/OidcClient.html">OidcClient</a> provides the raw OIDC/OAuth2 protocol
support</li>
</ul>
<p>The remainder of this document will primarily focus on the
<a href="classes/UserManager.html">UserManager</a>.</p>
<a id="md:principle-of-function" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Principle of function<a href="#md:principle-of-function" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>To understand how to use this library see here:</p>
<ul>
<li><a href="https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/authorization-code-grant-with-pkce.md">Authorization Code Grant with Proof Key for Code Exchange (PKCE)</a></li>
<li><a href="https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/authorization-code-grant.md">Authorization Code Grant</a></li>
<li><a href="https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/resource-owner-password-credentials-grant.md">Resource Owner Password Credentials (ROPC) Grant</a></li>
<li><a href="https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/refresh-token-grant.md">Refresh Token Grant</a></li>
<li><a href="https://github.com/authts/oidc-client-ts/blob/main/docs/protocols/silent-refresh-token-in-iframe-flow.md">Silent Refresh Token in iframe Flow</a></li>
</ul>
<a id="md:usermanager" class="tsd-anchor"></a><h1 class="tsd-anchor-link">UserManager<a href="#md:usermanager" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="md:configuration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration<a href="#md:configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <a href="classes/UserManager.html">UserManager</a> constructor requires a settings
object as a parameter:</p>
<ul>
<li><a href="interfaces/UserManagerSettings.html">UserManagerSettings</a> which extends</li>
<li><a href="interfaces/OidcClientSettings.html">OidcClientSettings</a></li>
</ul>
<a id="md:required-settings" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Required settings<a href="#md:required-settings" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><a href="interfaces/OidcClientSettings.html#authority">authority</a>: The URL of the
OIDC/OAuth2 provider.</li>
<li><a href="interfaces/OidcClientSettings.html#client_id">client_id</a>: Your client
application's identifier as registered with the OIDC/OAuth2 provider.</li>
<li><a href="interfaces/OidcClientSettings.html#redirect_uri">redirect_uri</a>: The redirect
URI of your client application to receive a response from the OIDC/OAuth2
provider.</li>
</ul>
<a id="md:provider-settings-if-cors-not-supported-on-oidcoauth2-provider-metadata-endpoint" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Provider settings if CORS not supported on OIDC/OAuth2 provider metadata endpoint<a href="#md:provider-settings-if-cors-not-supported-on-oidcoauth2-provider-metadata-endpoint" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <a href="interfaces/OidcClientSettings.html#authority">authority</a> URL setting is
used to make HTTP requests to discover more information about the OIDC/OAuth2
provider and populate a <code>metadata</code> property on the settings. If the server does
not allow CORS on the metadata endpoint, then these additional settings can be
manually configured. These values can be found on the metadata endpoint of the
provider:</p>
<ul>
<li>metadata property which contains:
<ul>
<li>issuer</li>
<li>authorization_endpoint</li>
<li>userinfo_endpoint</li>
<li>end_session_endpoint</li>
</ul>
</li>
<li><a href="interfaces/UserManagerSettings.html#metadataSeed">metadataSeed</a> can be used
to seed or add additional values to the results of the discovery request.</li>
</ul>
<a id="md:events" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Events<a href="#md:events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <a href="classes/UserManager.html">UserManager</a> will raise various events about the
user's session:</p>
<ul>
<li><a href="classes/UserManagerEvents.html">UserManagerEvents</a> which extends</li>
<li><a href="classes/AccessTokenEvents.html">AccessTokenEvents</a></li>
</ul>
<p>To register for the events, there is an <code>events</code> property on the
<a href="classes/UserManager.html">UserManager</a> with <code>addXxx</code> and <code>removeXxx</code> APIs to
add/remove callbacks for the events. An example:</p>
<pre><code class="javascript"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mgr</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">UserManager</span><span class="hl-1">();</span><br/><span class="hl-4">mgr</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-3">addAccessTokenExpiring</span><span class="hl-1">(</span><span class="hl-0">function</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-3">log</span><span class="hl-1">(</span><span class="hl-5">&quot;token expiring...&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:user" class="tsd-anchor"></a><h1 class="tsd-anchor-link">User<a href="#md:user" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The <a href="classes/User.html">User</a> type is returned from the <a href="classes/UserManager.html">UserManager</a>'s <a href="classes/UserManager.html#getUser">getUser</a> API.</p>
<a id="md:logging" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Logging<a href="#md:logging" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The oidc-client-ts library supports logging. You can set a logger by assigning <code>Oidc.Log.logger</code> to anything that supports a <code>info</code>, <code>warn</code>, and <code>error</code> methods that accept a params array. By default, no logger is configured.</p>
<p>The <code>console</code> object in the browser supports these, so a common way to easily
enable logging in the browser is to simply add this code:</p>
<pre><code class="javascript"><span class="hl-4">Oidc</span><span class="hl-1">.</span><span class="hl-4">Log</span><span class="hl-1">.</span><span class="hl-3">setLogger</span><span class="hl-1">(</span><span class="hl-4">console</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>Also, logging has levels so you can control the verbosity by calling
<code>Oidc.Log.setLevel()</code> with one of <code>Oidc.Log.NONE</code>, <code>Oidc.Log.ERROR</code>,
<code>Oidc.Log.WARN</code>, or <code>Oidc.Log.INFO</code>. The default is <code>Oidc.Log.INFO</code>.</p>
<a id="md:provider-specific-settings" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Provider specific settings<a href="#md:provider-specific-settings" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Additional provider specific settings may be needed for a flawless operation:</p>
<p><strong>Amazon Cognito</strong></p>
<pre><code class="javascript"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mgr</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">UserManager</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-6">// ...</span><br/><span class="hl-1">    </span><span class="hl-6">// no revoke of &quot;access token&quot; (https://github.com/authts/oidc-client-ts/issues/262)</span><br/><span class="hl-1">    </span><span class="hl-4">revokeTokenTypes:</span><span class="hl-1"> [</span><span class="hl-5">&quot;refresh_token&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">    </span><span class="hl-6">// no silent renew via &quot;prompt=none&quot; (https://github.com/authts/oidc-client-ts/issues/366)</span><br/><span class="hl-1">    </span><span class="hl-4">automaticSilentRenew:</span><span class="hl-1"> </span><span class="hl-0">false</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:custom-state-in-user-object" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Custom state in user object<a href="#md:custom-state-in-user-object" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>In case you would like to add additional data into the <a href="classes/User.html">User</a> object, you can do so during the initial sign-in request.</p>
<pre><code class="javascript"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mgr</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">UserManager</span><span class="hl-1">();</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">customState</span><span class="hl-1"> = { </span><span class="hl-4">foo:</span><span class="hl-1"> </span><span class="hl-5">&quot;bar&quot;</span><span class="hl-1"> };</span><br/><span class="hl-4">mgr</span><span class="hl-1">.</span><span class="hl-3">signinRedirect</span><span class="hl-1">({ </span><span class="hl-4">state:</span><span class="hl-1"> </span><span class="hl-4">customState</span><span class="hl-1"> });</span>
</code><button type="button">Copy</button></pre>

<p>After successful sign-in, the custom state is part of the <a href="classes/User.html#state">User</a> object as <code>state</code>. In case of failure, it is inside <a href="classes/ErrorResponse.html#state">ErrorResponse</a>.</p>
<p>This custom state should not be confused with the URL state parameter. The latter is internally used to match against the authentication state object to finish the authentication process.</p>
<a id="md:custom-state-in-request-url" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Custom state in request url<a href="#md:custom-state-in-request-url" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>If you would like to encode a custom state string in the sign-in request url, you can do so with the <code>url_state</code> parameter. You may want to do this in order to pass user state to the authentication server and/or a proxy and return that state as part of the response.</p>
<pre><code class="javascript"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">mgr</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">UserManager</span><span class="hl-1">();</span><br/><span class="hl-4">mgr</span><span class="hl-1">.</span><span class="hl-3">signinRedirect</span><span class="hl-1">({ </span><span class="hl-4">url_state:</span><span class="hl-1"> </span><span class="hl-5">&#39;custom url state&#39;</span><span class="hl-1"> })</span>
</code><button type="button">Copy</button></pre>

<p>The <code>url_state</code> will be appended to the opaque, unique value created by the library when sending the request. It should survive the round trip to your authentication server and will be part of the <a href="classes/User.html#url_state">User</a> object as <code>url_state</code>.</p>
<a id="md:hash-mode-router-spa" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Hash-mode router (SPA)<a href="#md:hash-mode-router-spa" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>If your app is using hash-based routing, be aware that many OIDC providers append the query string after the hash instead of inserting it before:<br>
<strong>Correct:</strong> <code>https://your.org/?code=ab&amp;state=cd#/oidc-callback</code><br>
<strong>Wrong:</strong> <code>https://your.org/#/oidc-callback?code=ab&amp;state=cd</code></p>
<p>Check out <a href="%5Bhttps://github.com/authts/oidc-client-ts/issues/734#issuecomment-1298381823%5D(https://github.com/authts/oidc-client-ts/issues/734)">this issue</a> for details. (There are also workarounds, as long as your provider doesn't fix the issue)</p>
<a id="md:projects-using-oidc-client-ts" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Projects using oidc-client-ts<a href="#md:projects-using-oidc-client-ts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><ul>
<li><a href="https://github.com/authts/react-oidc-context">React context provider</a></li>
<li><a href="https://github.com/authts/sample-angular-oidc-client-ts">Angular sample</a></li>
<li><a href="https://github.com/Alino/OIDC-client-ts-chromium-sample">Chrome service worker</a></li>
</ul>
<a id="md:training" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Training<a href="#md:training" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><ul>
<li><a href="https://www.pluralsight.com/courses/openid-and-oauth2-securing-angular-apps">Securing Angular Apps with OpenID Connect and OAuth2</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:principle-of-function"><span>Principle of function</span></a><a href="#md:usermanager"><span>User<wbr/>Manager</span></a><ul><li><a href="#md:configuration"><span>Configuration</span></a></li><li><ul><li><a href="#md:required-settings"><span>Required settings</span></a></li><li><a href="#md:provider-settings-if-cors-not-supported-on-oidcoauth2-provider-metadata-endpoint"><span>Provider settings if CORS not supported on OIDC/OAuth2 provider metadata endpoint</span></a></li></ul></li><li><a href="#md:events"><span>Events</span></a></li></ul><a href="#md:user"><span>User</span></a><a href="#md:logging"><span>Logging</span></a><a href="#md:provider-specific-settings"><span>Provider specific settings</span></a><a href="#md:custom-state-in-user-object"><span>Custom state in user object</span></a><a href="#md:custom-state-in-request-url"><span>Custom state in request url</span></a><a href="#md:hash-mode-router-spa"><span>Hash-<wbr/>mode router (SPA)</span></a><a href="#md:projects-using-oidc-client-ts"><span>Projects using oidc-<wbr/>client-<wbr/>ts</span></a><a href="#md:training"><span>Training</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>oidc-client-ts</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>